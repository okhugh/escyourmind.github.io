<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESCAPE YOUR MIND | Official Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap');
        
        :root {
            --bg-primary: #ffffff;
            --text-primary: #000000;
            --bg-secondary: #f4f4f5;
            --border-color: rgba(0, 0, 0, 0.1);
            --flashlight-x: 50%;
            --flashlight-y: 50%;
        }

        .dark-mode {
            --bg-primary: #000000;
            --text-primary: #ffffff;
            --bg-secondary: #18181b;
            --border-color: rgba(255, 255, 255, 0.1);
        }

        /* Special After Hours Theme override */
        .after-hours-theme {
            background-color: #050505 !important;
            color: #e2e2e2 !important;
        }
        .after-hours-theme img {
            filter: grayscale(1) !important;
        }
        .after-hours-theme .text-primary {
            color: #ffffff !important;
        }

        /* Replace Yellow with Dark Gray in After Hours Theme */
        .after-hours-theme .text-\[\#FFEE00\], 
        .after-hours-theme .hover\:text-\[\#FFEE00\]:hover {
            color: #a1a1aa !important;
        }
        .after-hours-theme .bg-\[\#FFEE00\],
        .after-hours-theme .hover\:bg-\[\#FFEE00\]:hover {
            background-color: #3f3f46 !important;
            color: #ffffff !important;
        }
        .after-hours-theme .border-\[\#FFEE00\],
        .after-hours-theme .hover\:border-\[\#FFEE00\]:hover,
        .after-hours-theme .group-hover\:border-\[\#FFEE00\],
        .after-hours-theme .focus\:border-\[\#FFEE00\] {
            border-color: #52525b !important;
        }

        /* Desktop Flashlight Overlay - Adjusted to 30% Opacity as requested */
        #flashlight-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 115;
            opacity: 0;
            transition: opacity 0.6s ease;
            background: radial-gradient(
                circle 350px at var(--flashlight-x) var(--flashlight-y),
                transparent 0%,
                rgba(0, 0, 0, 0.15) 50%,
                rgba(0, 0, 0, 0.7) 100%
            );
        }

        .flashlight-active #flashlight-overlay {
            opacity: 1;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .text-primary {
            color: var(--text-primary) !important;
        }

        ::selection {
            background-color: #FFEE00;
            color: black;
        }

        .custom-scroll::-webkit-scrollbar {
            width: 5px;
        }

        .custom-scroll::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: #FFEE00;
        }

        .nav-transition {
            transition: all 0.3s ease;
        }

        .scrolled {
            background-color: var(--bg-primary);
            opacity: 0.95;
            backdrop-filter: blur(12px);
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .mobile-menu {
            background-color: var(--bg-primary);
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }

        .mobile-menu.open {
            transform: translateX(0);
        }

        .view-section {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .view-section.active {
            display: block;
            opacity: 1;
        }

        .hero-gradient {
            background: linear-gradient(to top, var(--bg-primary) 0%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0) 100%);
        }

        /* Cart Feedback Effects */
        @keyframes cartPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); color: #FFEE00; }
            100% { transform: scale(1); }
        }

        .cart-pop-active {
            animation: cartPop 0.4s ease-out;
        }

        #add-notification {
            transform: translateY(-100%);
            transition: transform 0.4s cubic-bezier(0.17, 0.84, 0.44, 1);
        }

        #add-notification.show {
            transform: translateY(0);
        }

        .product-image-container:hover .secondary-image {
            opacity: 1;
        }
        
        .secondary-image {
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        /* Size Modal Overlay */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
        }

        .theme-btn {
            transition: transform 0.3s ease;
        }
        .theme-btn:active {
            transform: scale(0.9);
        }

        /* Themed Components */
        .bg-themed-secondary {
            background-color: var(--bg-secondary) !important;
            transition: background-color 0.3s ease;
        }

        /* Fixed specific black elements for light mode compatibility */
        .bg-zinc-950 { background-color: var(--bg-secondary) !important; }
        .bg-zinc-900 { background-color: var(--bg-secondary) !important; }
        .border-white\/10 { border-color: var(--border-color) !important; }
        .border-white\/5 { border-color: var(--border-color) !important; }
        .text-zinc-500 { color: #71717a !important; }
    </style>
</head>
<body class="custom-scroll">

    <!-- Flashlight Layer -->
    <div id="flashlight-overlay"></div>

    <!-- Add to Cart Notification Bubble -->
    <div id="add-notification" class="fixed top-0 left-0 w-full z-[100] p-4 flex justify-center pointer-events-none">
        <div class="bg-[#FFEE00] text-black px-6 py-3 shadow-2xl flex items-center gap-3">
            <i data-lucide="check-circle" size="20"></i>
            <span class="font-black uppercase tracking-tighter text-sm" id="notif-text">Added to Bag</span>
        </div>
    </div>

    <!-- Size Selection Modal -->
    <div id="size-modal" class="fixed inset-0 z-[140] flex items-center justify-center p-6 hidden">
        <div class="absolute inset-0 modal-overlay" onclick="closeSizeModal()"></div>
        <div class="relative bg-zinc-950 border border-white/10 p-8 max-w-sm w-full text-center shadow-2xl text-primary">
            <h3 class="text-xl font-black uppercase tracking-tighter mb-2">Select Size</h3>
            <p id="size-modal-product-name" class="text-[10px] text-zinc-500 uppercase font-black mb-8"></p>
            
            <div class="grid grid-cols-3 gap-3 mb-8">
                <button onclick="confirmQuickAdd('S')" class="h-12 border border-white/10 flex items-center justify-center font-black hover:border-[#FFEE00] hover:text-[#FFEE00] transition-colors uppercase">S</button>
                <button onclick="confirmQuickAdd('M')" class="h-12 border border-white/10 flex items-center justify-center font-black hover:border-[#FFEE00] hover:text-[#FFEE00] transition-colors uppercase">M</button>
                <button onclick="confirmQuickAdd('L')" class="h-12 border border-white/10 flex items-center justify-center font-black hover:border-[#FFEE00] hover:text-[#FFEE00] transition-colors uppercase">L</button>
                <button onclick="confirmQuickAdd('XL')" class="h-12 border border-white/10 flex items-center justify-center font-black hover:border-[#FFEE00] hover:text-[#FFEE00] transition-colors uppercase">XL</button>
                <button onclick="confirmQuickAdd('2XL')" class="h-12 border border-white/10 flex items-center justify-center font-black hover:border-[#FFEE00] hover:text-[#FFEE00] transition-colors uppercase col-span-2">2XL</button>
            </div>
            
            <button onclick="closeSizeModal()" class="text-zinc-500 uppercase font-black text-[10px] tracking-widest hover:text-[#FFEE00]">Cancel</button>
        </div>
    </div>

    <!-- Navigation -->
    <nav id="navbar" class="fixed w-full z-[120] nav-transition py-4 md:py-6 px-4 md:px-6">
        <div class="max-w-7xl mx-auto flex justify-between items-center text-primary">
            <div class="flex items-center gap-4 md:gap-8">
                <button class="lg:hidden" onclick="toggleMenu(true)">
                    <i data-lucide="menu" size="22"></i>
                </button>
                <h1 onclick="navigateTo('home')" class="text-lg md:text-2xl font-black tracking-tighter uppercase cursor-pointer">
                    ESCAPE<span class="text-[#FFEE00]">YOUR</span>MIND
                </h1>
                <div class="hidden lg:flex gap-6 text-sm font-medium uppercase tracking-widest text-zinc-500">
                    <button onclick="navigateTo('new_drop')" class="hover:text-[#FFEE00] transition-colors">New Drop</button>
                    <button onclick="navigateTo('men')" class="hover:text-[#FFEE00] transition-colors">Men</button>
                    <button onclick="navigateTo('women')" class="hover:text-[#FFEE00] transition-colors">Women</button>
                    <button onclick="navigateTo('sale')" class="hover:text-[#FFEE00] transition-colors text-[#FFEE00]">Sale</button>
                </div>
            </div>

            <div class="flex items-center gap-3 md:gap-5">
                <button onclick="toggleTheme()" class="theme-btn hover:text-[#FFEE00] transition-colors p-1" title="Toggle Theme">
                    <i id="theme-icon" data-lucide="moon" size="20"></i>
                </button>
                <button onclick="navigateTo('coming_soon')" class="hover:text-[#FFEE00] transition-colors p-1" title="Coming Soon">
                    <i data-lucide="clock" size="20"></i>
                </button>
                <button onclick="navigateTo('search')" class="hover:text-[#FFEE00] transition-colors p-1">
                    <i data-lucide="search" size="20"></i>
                </button>
                <button onclick="navigateTo('wishlist')" class="hover:text-[#FFEE00] transition-colors relative p-1" title="Wishlist">
                    <i data-lucide="heart" size="20" id="wishlist-header-icon"></i>
                    <span id="wishlist-count" class="absolute -top-1 -right-1 bg-[#FFEE00] text-black text-[8px] font-bold h-3 w-3 rounded-full flex items-center justify-center hidden">0</span>
                </button>
                <button onclick="navigateTo('login')" class="flex items-center gap-2 hover:text-[#FFEE00] transition-colors group p-1">
                    <i data-lucide="user" size="20"></i>
                    <span class="text-xs font-bold uppercase tracking-tighter hidden lg:block">Login</span>
                </button>
                <button id="cart-nav-btn" onclick="navigateTo('cart')" class="relative group p-1 text-primary">
                    <i data-lucide="shopping-bag" size="20" class="group-hover:text-[#FFEE00] transition-colors"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-[#FFEE00] text-black text-[10px] font-bold h-4 w-4 rounded-full flex items-center justify-center">0</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="fixed inset-0 z-[130] p-6 mobile-menu shadow-2xl text-primary">
        <div class="flex justify-between items-center mb-12">
            <h1 class="text-xl font-black uppercase text-primary font-black">ESCAPE<span class="text-[#FFEE00]">YOUR</span>MIND</h1>
            <button onclick="toggleMenu(false)"><i data-lucide="x" size="32"></i></button>
        </div>
        <div class="flex flex-col gap-8 text-4xl font-black uppercase text-left">
            <button onclick="navigateTo('home'); toggleMenu(false)" class="text-[#FFEE00]">Home</button>
            <button onclick="navigateTo('new_drop'); toggleMenu(false)">New Drop</button>
            <button onclick="navigateTo('men'); toggleMenu(false)">Men</button>
            <button onclick="navigateTo('women'); toggleMenu(false)">Women</button>
            <button onclick="navigateTo('sale'); toggleMenu(false)">Sale</button>
            <button onclick="navigateTo('coming_soon'); toggleMenu(false)">Coming Soon</button>
            <button onclick="navigateTo('wishlist'); toggleMenu(false)">Wishlist</button>
            <button onclick="navigateTo('login'); toggleMenu(false)">Account</button>
        </div>
    </div>

    <!-- MAIN VIEWS -->
    <div id="views-container">
        
        <!-- Home View -->
        <section id="view-home" class="view-section active">
            <div class="relative h-screen flex items-center overflow-hidden">
                <div class="absolute inset-0 z-0">
                    <img src="https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?auto=format&fit=crop&q=80&w=2000" class="w-full h-full object-cover grayscale opacity-80" alt="Hero">
                    <div class="absolute inset-0 hero-gradient"></div>
                </div>
                <div class="relative z-10 max-w-7xl mx-auto px-6 w-full mt-20 text-center md:text-left">
                    <p class="text-[#FFEE00] font-bold uppercase tracking-[0.3em] mb-4 text-xs md:text-sm animate-pulse">F/W 2026 DROP NOW LIVE</p>
                    <h2 class="text-5xl md:text-9xl font-black uppercase leading-[0.85] mb-8 tracking-tighter text-primary font-black">LUCID<br /><span class="text-[#FFEE00]">BODY.</span></h2>
                    <button onclick="navigateTo('new_drop')" class="bg-[#FFEE00] text-black px-10 py-5 font-black uppercase tracking-tighter hover:bg-black hover:text-white transition-all transform hover:-translate-y-1 flex items-center gap-2 group mx-auto md:mx-0 shadow-lg">
                        Shop Collection <i data-lucide="arrow-right" size="20"></i>
                    </button>
                </div>
            </div>

            <!-- Categories Grid -->
            <section class="py-24 max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div onclick="navigateTo('outerwear')" class="group relative aspect-square overflow-hidden cursor-pointer bg-themed-secondary">
                    <img src="https://images.unsplash.com/photo-1551488831-00ddcb6c6bd3?auto=format&fit=crop&q=80&w=1400" class="w-full h-full object-cover opacity-80 transition-transform duration-700 group-hover:scale-105" />
                    <div class="absolute inset-0 bg-black/20 group-hover:bg-black/40 transition-colors"></div>
                    <div class="absolute bottom-8 left-8">
                        <h3 class="text-2xl font-black uppercase text-white">Outerwear</h3>
                        <div class="w-12 h-1 bg-[#FFEE00] mt-2 group-hover:w-full transition-all duration-500"></div>
                    </div>
                </div>
                <div onclick="navigateTo('streetwear')" class="group relative aspect-square overflow-hidden cursor-pointer bg-themed-secondary">
                    <img src="https://images.unsplash.com/photo-1523381210434-271e8be1f52b?auto=format&fit=crop&q=80&w=1400" class="w-full h-full object-cover opacity-80 transition-transform duration-700 group-hover:scale-105" />
                    <div class="absolute inset-0 bg-black/20 group-hover:bg-black/40 transition-colors"></div>
                    <div class="absolute bottom-8 left-8">
                        <h3 class="text-2xl font-black uppercase text-white">Streetwear</h3>
                        <div class="w-12 h-1 bg-[#FFEE00] mt-2 group-hover:w-full transition-all duration-500"></div>
                    </div>
                </div>
                <div onclick="navigateTo('accessories')" class="group relative aspect-square overflow-hidden cursor-pointer bg-themed-secondary">
                    <img src="https://images.unsplash.com/photo-1509100194014-d49809396daa?auto=format&fit=crop&q=80&w=1400" class="w-full h-full object-cover opacity-80 transition-transform duration-700 group-hover:scale-105" />
                    <div class="absolute inset-0 bg-black/20 group-hover:bg-black/40 transition-colors"></div>
                    <div class="absolute bottom-8 left-8">
                        <h3 class="text-2xl font-black uppercase text-white">Accessories</h3>
                        <div class="w-12 h-1 bg-[#FFEE00] mt-2 group-hover:w-full transition-all duration-500"></div>
                    </div>
                </div>
            </section>

            <!-- Essentials Preview -->
            <section class="py-24 bg-themed-secondary text-primary">
                <div class="max-w-7xl mx-auto px-6">
                    <div class="flex justify-between items-end mb-12">
                        <div>
                            <h2 class="text-4xl font-black uppercase tracking-tighter text-primary">The Essentials</h2>
                            <p class="text-zinc-500 mt-2 font-medium tracking-wide">Wearable reminders to exit your head and enter the moment.</p>
                        </div>
                        <button onclick="navigateTo('essentials')" class="flex items-center gap-2 text-[#FFEE00] font-bold uppercase tracking-tighter hover:text-black dark:hover:text-white transition-colors">
                            Browse All <i data-lucide="chevron-right" size="18"></i>
                        </button>
                    </div>
                    <div id="essentials-preview-grid" class="grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-8">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </section>
        </section>

        <!-- Collection / Category View -->
        <section id="view-collection" class="view-section py-32 px-4 md:px-6 max-w-7xl mx-auto min-h-screen text-primary font-black">
            <button onclick="handleBack()" class="flex items-center gap-2 text-zinc-400 hover:text-[#FFEE00] uppercase font-black text-[10px] tracking-widest mb-8 transition-colors">
                <i data-lucide="chevron-left" size="14"></i> Back
            </button>
            <h2 id="collection-title" class="text-4xl md:text-5xl font-black uppercase tracking-tighter mb-4">COLLECTION</h2>
            <div class="w-20 h-2 bg-[#FFEE00] mb-12"></div>
            <div id="collection-grid" class="grid grid-cols-2 lg:grid-cols-4 gap-x-4 md:gap-x-6 gap-y-10 md:gap-y-12">
                <!-- Grid Generated by JS -->
            </div>
        </section>

        <!-- Coming Soon View -->
        <section id="view-coming_soon" class="view-section py-32 px-4 md:px-6 max-w-7xl mx-auto min-h-screen text-primary font-black">
            <button onclick="handleBack()" class="flex items-center gap-2 text-zinc-400 hover:text-[#FFEE00] uppercase font-black text-[10px] tracking-widest mb-8 transition-colors">
                <i data-lucide="chevron-left" size="14"></i> Back
            </button>
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-12 gap-8">
                <div>
                    <h2 class="text-4xl md:text-5xl font-black uppercase tracking-tighter mb-2 text-primary">Coming Soon</h2>
                    <p class="text-zinc-500 uppercase font-black text-xs tracking-widest text-primary">Next Drop Access Restricted</p>
                </div>
                <div class="flex gap-4 md:gap-8 bg-zinc-100 dark:bg-zinc-900 p-4 px-6 md:px-10 rounded-sm shadow-xl border border-zinc-200 dark:border-white/5">
                    <div class="text-center">
                        <span class="block text-2xl md:text-3xl font-black">0</span>
                        <span class="text-[8px] font-black uppercase tracking-widest opacity-50">Days</span>
                    </div>
                    <div class="text-center border-l border-zinc-200 dark:border-white/5 pl-4 md:pl-8">
                        <span class="block text-2xl md:text-3xl font-black">0</span>
                        <span class="text-[8px] font-black uppercase tracking-widest opacity-50">Hours</span>
                    </div>
                    <div class="text-center border-l border-zinc-200 dark:border-white/5 pl-4 md:pl-8">
                        <span class="block text-2xl md:text-3xl font-black">0</span>
                        <span class="text-[8px] font-black uppercase tracking-widest opacity-50">Mins</span>
                    </div>
                    <div class="text-center border-l border-zinc-200 dark:border-white/5 pl-4 md:pl-8">
                        <span class="block text-2xl md:text-3xl font-black">0</span>
                        <span class="text-[8px] font-black uppercase tracking-widest opacity-50">Secs</span>
                    </div>
                </div>
            </div>
            <div class="w-full h-1 bg-zinc-100 dark:bg-zinc-900 mb-12"></div>
            <div id="coming-soon-grid" class="grid grid-cols-2 lg:grid-cols-4 gap-x-4 md:gap-x-6 gap-y-10 md:gap-y-12">
                <!-- Loaded by JS -->
            </div>
        </section>

        <!-- Wishlist View -->
        <section id="view-wishlist" class="view-section py-32 px-4 md:px-6 max-w-7xl mx-auto min-h-screen text-primary font-black">
            <button onclick="handleBack()" class="flex items-center gap-2 text-zinc-400 hover:text-[#FFEE00] uppercase font-black text-[10px] tracking-widest mb-8 transition-colors">
                <i data-lucide="chevron-left" size="14"></i> Back
            </button>
            <h2 class="text-4xl md:text-5xl font-black uppercase tracking-tighter mb-4 text-primary">Wishlist</h2>
            <div class="w-20 h-2 bg-[#FFEE00] mb-12"></div>
            <div id="wishlist-grid" class="grid grid-cols-2 lg:grid-cols-4 gap-x-4 md:gap-x-6 gap-y-10 md:gap-y-12">
                <!-- Loaded by JS -->
            </div>
        </section>

        <!-- Product Detail View -->
        <section id="view-product-detail" class="view-section py-32 px-4 md:px-6 max-w-7xl mx-auto min-h-screen">
            <!-- Dynamic Content -->
        </section>

        <!-- Search View -->
        <section id="view-search" class="view-section py-32 px-4 md:px-6 max-w-7xl mx-auto min-h-screen text-primary">
            <button onclick="handleBack()" class="flex items-center gap-2 text-zinc-400 hover:text-[#FFEE00] uppercase font-black text-[10px] tracking-widest mb-8 transition-colors">
                <i data-lucide="chevron-left" size="14"></i> Back
            </button>
            <input type="text" id="search-input" oninput="handleSearch(this.value)" placeholder="SEARCH COLLECTION..." class="w-full bg-transparent border-b-2 border-zinc-200 dark:border-white/10 pb-4 text-3xl md:text-6xl font-black uppercase tracking-tighter outline-none focus:border-[#FFEE00] transition-colors text-primary font-black">
            <div id="search-results-grid" class="mt-12 grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-8"></div>
        </section>

        <!-- Cart View -->
        <section id="view-cart" class="view-section py-32 px-4 md:px-6 max-w-3xl mx-auto min-h-screen text-primary font-black">
            <button onclick="handleBack()" class="flex items-center gap-2 text-zinc-400 hover:text-[#FFEE00] uppercase font-black text-[10px] tracking-widest mb-8 transition-colors">
                <i data-lucide="chevron-left" size="14"></i> Back
            </button>
            <h2 class="text-4xl md:text-5xl font-black uppercase tracking-tighter mb-12 text-primary font-black">Your Cart</h2>
            <div id="cart-items-container" class="space-y-6"></div>
            <div id="cart-footer" class="mt-12 pt-8 border-t border-zinc-100 dark:border-white/10 flex justify-between items-end hidden">
                <div>
                    <p class="text-zinc-400 text-[10px] font-black uppercase tracking-widest">Total Amount</p>
                    <p id="cart-total" class="text-3xl md:text-4xl font-black text-[#FFEE00] font-black font-mono">$0.00</p>
                </div>
                <button class="bg-[#FFEE00] text-black px-10 md:px-12 py-5 font-black uppercase tracking-tighter hover:bg-black hover:text-white transition-colors shadow-lg">Checkout</button>
            </div>
        </section>

        <!-- Login / Signup View -->
        <section id="view-login" class="view-section py-20 px-6 max-w-7xl mx-auto text-primary">
            <div class="max-w-md mx-auto">
                <button onclick="handleBack()" class="flex items-center gap-2 text-zinc-400 hover:text-[#FFEE00] uppercase font-black text-[10px] tracking-widest mb-12 transition-colors">
                    <i data-lucide="chevron-left" size="14"></i> Back
                </button>
                <div class="text-center mb-12">
                    <h2 id="auth-title" class="text-4xl md:text-5xl font-black uppercase tracking-tighter mb-4 font-black">MEMBER<br/><span class="text-[#FFEE00]">ACCESS</span></h2>
                    <p id="auth-subtitle" class="text-zinc-500 font-bold tracking-widest text-xs uppercase">Enter your credentials to continue.</p>
                </div>
                
                <form action="auth.php" method="POST" class="space-y-8">
                    <input type="hidden" id="auth-action" name="action" value="login">
                    <div id="signup-name-field" class="space-y-2 group hidden">
                        <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 group-focus-within:text-[#FFEE00]">Full Name</label>
                        <input type="text" name="name" class="w-full bg-transparent border-b-2 border-zinc-200 dark:border-white/10 py-3 outline-none focus:border-[#FFEE00] font-bold tracking-tight text-primary">
                    </div>
                    <div class="space-y-2 group">
                        <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 group-focus-within:text-[#FFEE00]">Email Address</label>
                        <input type="email" name="email" required class="w-full bg-transparent border-b-2 border-zinc-200 dark:border-white/10 py-3 outline-none focus:border-[#FFEE00] font-bold tracking-tight text-primary">
                    </div>
                    <div class="space-y-2 group">
                        <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 group-focus-within:text-[#FFEE00]">Password</label>
                        <input type="password" name="password" required class="w-full bg-transparent border-b-2 border-white/10 py-3 outline-none focus:border-[#FFEE00] font-bold tracking-tight text-primary">
                    </div>
                    <button type="submit" id="auth-submit-btn" class="w-full bg-[#FFEE00] text-black py-5 font-black uppercase tracking-tighter hover:bg-black hover:text-white transition-all transform hover:-translate-y-1 text-xs md:text-sm shadow-xl font-black">Sign In</button>
                </form>

                <div class="mt-12 text-center text-primary">
                    <p class="text-zinc-500 text-[10px] font-black uppercase tracking-widest font-bold">
                        <span id="auth-switch-text">Not a member?</span> 
                        <button onclick="toggleAuthMode()" id="auth-switch-btn" class="text-[#FFEE00] ml-2 hover:underline">Join the Collective</button>
                    </p>
                    <button onclick="navigateTo('home')" class="mt-8 text-xs font-black uppercase tracking-tighter text-zinc-400 hover:text-[#FFEE00] flex items-center justify-center gap-2 mx-auto font-black">
                        <i data-lucide="arrow-left" size="14"></i> Back to Store
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer id="main-footer" class="border-t border-zinc-100 dark:border-white/5 pt-20 pb-10 mt-20 text-primary">
        <div class="max-w-7xl mx-auto px-6 text-primary">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-20 text-center md:text-left">
                <div>
                    <h1 class="text-2xl font-black mb-6 uppercase text-primary">ESCAPE<span class="text-[#FFEE00]">YOUR</span>MIND</h1>
                    <p class="text-zinc-500 text-sm leading-relaxed mb-6 font-medium">For your confidence, by the confident. Based in Atlanta, shipping worldwide.</p>
                    <div class="flex gap-4 justify-center md:justify-start">
                        <a href="https://www.instagram.com/escyourmind/" target="_blank" rel="noopener noreferrer">
                            <i data-lucide="instagram" class="text-zinc-400 hover:text-[#FFEE00] cursor-pointer transition-colors"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h4 class="font-black uppercase tracking-widest text-xs mb-8 text-[#FFEE00]">Shop</h4>
                    <ul class="space-y-4 text-sm font-bold text-zinc-500 uppercase font-black">
                        <li><button onclick="navigateTo('new_drop')" class="hover:text-[#FFEE00]">New Arrivals</button></li>
                        <li><button onclick="navigateTo('essentials')" class="hover:text-[#FFEE00]">Bestsellers</button></li>
                        <li><button onclick="navigateTo('accessories')" class="hover:text-[#FFEE00]">Accessories</button></li>
                        <li><button onclick="navigateTo('coming_soon')" class="hover:text-[#FFEE00]">Coming Soon</button></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-black uppercase tracking-widest text-xs mb-8 text-[#FFEE00]">Support</h4>
                    <ul class="space-y-4 text-sm font-bold text-zinc-500 uppercase font-black">
                        <li><a href="#" class="hover:text-[#FFEE00]">Track Order</a></li>
                        <li><a href="#" class="hover:text-[#FFEE00]">Shipping</a></li>
                        <li><a href="#" class="hover:text-[#FFEE00]">Returns</a></li>
                    </ul>
                </div>
                <div class="bg-themed-secondary p-6 border border-zinc-100 dark:border-white/5">
                    <h4 class="font-black uppercase tracking-widest text-[10px] text-[#FFEE00] mb-4">Status</h4>
                    <div class="flex items-center gap-2 mb-2 justify-center md:justify-start">
                        <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        <span class="text-[10px] font-black uppercase text-primary">Logistics Normal</span>
                    </div>
                </div>
            </div>
            <p class="text-[10px] font-bold text-zinc-400 tracking-widest uppercase text-center">© 2026 Escape Your Mind Collective. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        // State
        let currentView = 'home';
        let currentProductId = null;
        let cart = [];
        let wishlist = [];
        let isSignUp = false;
        let viewHistory = [];
        let pendingQuickAddId = null;
        let isDarkMode = false;

        const sanctuaryDesc = "Silence the noise. Step out of the cycle. \n\n Our signature hoodie is designed as a physical reminder to detach yourself from any thoughts or internal dialogue that limits your endless potential. With its heavyweight build that provides a sense of security and oversized fit that provides a sense of utmost comfort, this is more than a garment—it's a sanctuary.";

        // Inventory
        const collection = [
            { id: 'h1', name: '"DOPAMINE RUSH" LUCID ESCAPE HOODIE', price: '$49.80', oldPrice: '$60.00', category: 'F/W 2026', imgFront: 'lucid_dopamine_rush_hoodie_FRONT.png', imgBack: 'lucid_dopamine_rush_hoodie_BACK.png', desc: sanctuaryDesc },
            { id: 'h2', name: '"CONCRETE FOG" LUCID ESCAPE HOODIE', price: '$49.80', oldPrice: '$60.00', category: 'F/W 2026', imgFront: 'lucid_concrete_fog_hoodie_FRONT.png', imgBack: 'lucid_concrete_fog_hoodie_BACK.png', desc: sanctuaryDesc },
            { id: 'h3', name: '"PINE SOLACE" LUCID ESCAPE HOODIE', price: '$49.80', oldPrice: '$60.00', category: 'F/W 2026', imgFront: 'lucid_pine_solace_hoodie_FRONT.png', imgBack: 'lucid_pine_solace_hoodie_BACK.png', desc: sanctuaryDesc + "\n\n This pine-inspired palette is a special edition release.", isSpecial: true },
            { id: 'h4', name: '"VOID" LUCID ESCAPE HOODIE', price: '$49.80', oldPrice: '$60.00', category: 'F/W 2026', imgFront: 'lucid_void_hoodie_FRONT.png', imgBack: 'lucid_void_hoodie_BACK.png', desc: sanctuaryDesc },
            { id: 'h5', name: '"DEEP SLEEP" LUCID ESCAPE HOODIE', price: '$49.80', oldPrice: '$60.00', category: 'F/W 2026', imgFront: 'lucid_deep_sleep_hoodie_FRONT.png', imgBack: 'lucid_deep_sleep_hoodie_BACK.png', desc: sanctuaryDesc + "\n\n This navy night palette is a special edition release.", isSpecial: true }
        ];

        const comingSoon = [
            { 
                id: 'ah1', name: '"AFTER HOURS" ESCAPE FUR HOODIE', price: '$80.00', oldPrice: '', category: 'AFTER HOURS', imgFront: 'after_hours_fur_hoodie_FRONT.png', imgBack: 'after_hours_fur_hoodie_BACK.png', units: 25,
                desc: "The sun goes down, the noise fades, but the mind stays loud. \n\n Dropping at the first tick of midnight, the \"After Hours\" ESCAPE Fur Hoodie is designed for those quiet hours when your thoughts try to take over. This piece provides refuge in style during your coldest nights featuring a detachable fur hood.",
                material: "Cotton Blend"
            },
            { 
                id: 'ah2', name: '"AFTER HOURS" ESCAPE JOGGERS', price: '$30.00', oldPrice: '', category: 'AFTER HOURS', imgFront: 'after_hours_joggers_FRONT.png', imgBack: 'after_hours_joggers_BACK.png', units: 25,
                desc: "The sun goes down, the noise fades, but the mind stays loud. \n\n Dropping at the first tick of midnight, the \"After Hours\" ESCAPE Joggers are designed for those quiet hours when your thoughts try to take over. This piece provides refuge in style during your coldest nights featuring a dark, washed, and versatile look to go with any of your other pieces.",
                material: "Cotton Blend"
            }
        ];

        const allInventory = [...collection, ...comingSoon];

        // Global Mouse Flashlight
        function updateFlashlightCoords(e) {
            document.documentElement.style.setProperty('--flashlight-x', e.clientX + 'px');
            document.documentElement.style.setProperty('--flashlight-y', e.clientY + 'px');
        }
        window.addEventListener('mousemove', updateFlashlightCoords);

        // Persistence Helpers
        function saveProgress() {
            localStorage.setItem('oa_cart', JSON.stringify(cart));
            localStorage.setItem('oa_wishlist', JSON.stringify(wishlist));
        }

        function loadProgress() {
            const savedCart = localStorage.getItem('oa_cart');
            const savedWishlist = localStorage.getItem('oa_wishlist');
            if (savedCart) cart = JSON.parse(savedCart);
            if (savedWishlist) wishlist = JSON.parse(savedWishlist);
            updateWishlistBadge();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode', isDarkMode);
            localStorage.setItem('oa_theme', isDarkMode ? 'dark' : 'light');
            updateThemeIcon();
            refreshCurrentView();
        }

        function updateThemeIcon() {
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.setAttribute('data-lucide', isDarkMode ? 'sun' : 'moon');
                lucide.createIcons();
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('oa_theme');
            isDarkMode = savedTheme === 'dark';
            document.body.classList.toggle('dark-mode', isDarkMode);
            updateThemeIcon();
        }

        // Core Functions
        function navigateTo(viewId, productId = null, saveToHistory = true) {
            if (saveToHistory && currentView !== viewId) {
                viewHistory.push({ view: currentView, id: currentProductId });
            }
            if (viewId === 'home') viewHistory = [];

            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.body.classList.remove('after-hours-theme', 'flashlight-active');

            currentView = viewId;
            currentProductId = productId;

            if (viewId === 'product_detail' && productId) {
                renderProductDetail(productId);
                document.getElementById('view-product-detail').classList.add('active');
                if (productId.startsWith('ah')) {
                    document.body.classList.add('after-hours-theme');
                    if (window.innerWidth >= 1024) document.body.classList.add('flashlight-active');
                }
            } else if (['new_drop', 'men', 'women', 'sale', 'outerwear', 'streetwear', 'accessories', 'essentials'].includes(viewId)) {
                renderCollection(viewId);
                document.getElementById('view-collection').classList.add('active');
            } else if (viewId === 'coming_soon') {
                renderComingSoon();
                document.getElementById('view-coming_soon').classList.add('active');
            } else if (viewId === 'wishlist') {
                renderWishlist();
                document.getElementById('view-wishlist').classList.add('active');
            } else {
                const target = document.getElementById(`view-${viewId}`);
                if (target) target.classList.add('active');
            }

            window.scrollTo(0, 0);
            lucide.createIcons();
        }

        function handleBack() {
            if (viewHistory.length > 0) {
                const prev = viewHistory.pop();
                navigateTo(prev.view, prev.id, false);
            } else {
                navigateTo('home', null, false);
            }
        }

        function toggleMenu(isOpen) {
            const menu = document.getElementById('mobile-menu');
            if (isOpen) menu.classList.add('open');
            else menu.classList.remove('open');
        }

        function toggleAuthMode() {
            isSignUp = !isSignUp;
            const title = document.getElementById('auth-title');
            const submit = document.getElementById('auth-submit-btn');
            const toggle = document.getElementById('signup-name-field');
            title.innerHTML = isSignUp ? 'JOIN THE<br/><span class="text-[#FFEE00]">COLLECTIVE</span>' : 'MEMBER<br/><span class="text-[#FFEE00]">ACCESS</span>';
            submit.innerText = isSignUp ? 'Join Now' : 'Sign In';
            toggle.classList.toggle('hidden', !isSignUp);
        }

        function toggleWishlist(productId) {
            const product = allInventory.find(i => i.id === productId);
            const index = wishlist.findIndex(item => item.id === productId);
            if (index === -1) {
                wishlist.push(product);
                showNotification("Added to Wishlist");
            } else {
                wishlist.splice(index, 1);
                showNotification("Removed from Wishlist");
            }
            saveProgress();
            updateWishlistBadge();
            refreshCurrentView();
        }

        function updateWishlistBadge() {
            const badge = document.getElementById('wishlist-count');
            const icon = document.getElementById('wishlist-header-icon');
            if (wishlist.length > 0) {
                badge.innerText = wishlist.length;
                badge.classList.remove('hidden');
                icon.classList.add('fill-[#FFEE00]', 'text-[#FFEE00]');
            } else {
                badge.classList.add('hidden');
                icon.classList.remove('fill-[#FFEE00]', 'text-[#FFEE00]');
            }
        }

        function openSizeModal(productId) {
            pendingQuickAddId = productId;
            const product = allInventory.find(p => p.id === productId);
            document.getElementById('size-modal-product-name').innerText = product.name;
            document.getElementById('size-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeSizeModal() {
            document.getElementById('size-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
            pendingQuickAddId = null;
        }

        function confirmQuickAdd(size) {
            if (pendingQuickAddId) {
                const product = allInventory.find(p => p.id === pendingQuickAddId);
                if (product) {
                    cart.push({ ...product, size: size, cartId: Date.now() });
                    updateCartUI();
                    saveProgress();
                    showNotification(`${product.name} (${size}) Added to Bag`);
                }
            }
            closeSizeModal();
        }

        function createProductCard(product) {
            const isAH = product.id.startsWith('ah');
            const inWishlist = wishlist.some(item => item.id === product.id);
            return `
                <div class="group cursor-pointer" onclick="navigateTo('product_detail', '${product.id}')">
                    <div class="relative aspect-square overflow-hidden bg-themed-secondary mb-4 product-image-container shadow-sm">
                        <img src="${product.imgFront}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 opacity-90 ${isAH ? 'grayscale' : ''}" loading="lazy">
                        <img src="${product.imgBack}" class="absolute inset-0 w-full h-full object-cover secondary-image opacity-0 group-hover:opacity-90 transition-opacity duration-500 ${isAH ? 'grayscale' : ''}">
                        <div class="absolute top-2 left-2 flex flex-col gap-1">
                            ${isAH ? `<span class="bg-black text-white text-[7px] font-black px-2 py-1 uppercase tracking-widest border border-white/10">Ltd: ${product.units} Units</span>` : ''}
                            ${product.isSpecial ? `<span class="bg-[#FFEE00] text-black text-[7px] font-black px-2 py-1 uppercase tracking-widest">Special Ed.</span>` : ''}
                        </div>
                        <div class="absolute top-2 right-2 md:opacity-0 md:group-hover:opacity-100 transition-opacity">
                            <button onclick="event.stopPropagation(); toggleWishlist('${product.id}')" class="bg-white text-black p-2 rounded-full hover:bg-[#FFEE00] shadow-xl transition-all">
                                <i data-lucide="heart" size="18" class="${inWishlist ? 'fill-black' : ''}"></i>
                            </button>
                        </div>
                        <div class="absolute bottom-0 left-0 right-0 p-4 translate-y-full md:group-hover:translate-y-0 transition-transform duration-300">
                            <button onclick="event.stopPropagation(); openSizeModal('${product.id}')" class="w-full bg-[#FFEE00] text-black py-3 font-black uppercase text-[10px] tracking-tighter flex items-center justify-center gap-2 shadow-lg">
                                Add to Bag <i data-lucide="shopping-bag" size="14"></i>
                            </button>
                        </div>
                        <div class="md:hidden absolute bottom-2 right-2">
                             <button onclick="event.stopPropagation(); openSizeModal('${product.id}')" class="bg-[#FFEE00] text-black p-2 rounded-full shadow-lg">
                                <i data-lucide="plus" size="20"></i>
                            </button>
                        </div>
                    </div>
                    <div class="space-y-1 px-1">
                        <p class="text-[8px] text-[#FFEE00] font-black uppercase tracking-[0.2em] text-primary font-black">${product.category}</p>
                        <h4 class="font-bold text-xs md:text-sm uppercase group-hover:text-[#FFEE00] transition-colors text-primary font-black leading-tight">${product.name}</h4>
                        <p class="font-mono text-xs">
                            ${product.oldPrice ? `<span class="line-through text-zinc-400 mr-2">${product.oldPrice}</span>` : ''}
                            <span class="text-primary font-bold">${product.price}</span>
                        </p>
                    </div>
                </div>
            `;
        }

        function renderCollection(viewId) {
            const titleMap = { new_drop: 'New Drop', men: 'Men', women: 'Women', sale: 'Sale', outerwear: 'Outerwear', streetwear: 'Streetwear', accessories: 'Accessories', essentials: 'All Essentials' };
            const titleElement = document.getElementById('collection-title');
            const gridElement = document.getElementById('collection-grid');
            titleElement.innerText = titleMap[viewId] || 'Collection';
            if (viewId === 'accessories') {
                gridElement.classList.remove('grid');
                gridElement.innerHTML = `<div class="col-span-full py-24 text-center text-primary"><i data-lucide="info" class="mx-auto mb-6 text-zinc-300 dark:text-zinc-700" size="48"></i><p class="text-xl md:text-2xl font-black uppercase tracking-tighter text-zinc-400 px-4">Whoops! Nothing here yet, check back later.</p><button onclick="handleBack()" class="mt-8 text-[#FFEE00] uppercase font-black tracking-widest text-xs hover:underline">Go Back</button></div>`;
            } else {
                gridElement.classList.add('grid');
                gridElement.innerHTML = collection.map(p => createProductCard(p)).join('');
            }
            lucide.createIcons();
        }

        function renderComingSoon() {
            document.getElementById('coming-soon-grid').innerHTML = comingSoon.map(p => createProductCard(p)).join('');
            lucide.createIcons();
        }

        function renderWishlist() {
            const gridElement = document.getElementById('wishlist-grid');
            if (wishlist.length === 0) {
                gridElement.classList.remove('grid');
                gridElement.innerHTML = `<div class="col-span-full py-24 text-center"><i data-lucide="heart" class="mx-auto mb-6 text-zinc-200 dark:text-zinc-800" size="48"></i><p class="text-xl md:text-2xl font-black uppercase tracking-tighter text-zinc-400 px-4">Your wishlist is empty.</p><button onclick="navigateTo('home')" class="mt-8 text-[#FFEE00] uppercase font-black tracking-widest text-xs hover:underline">Return to Store</button></div>`;
            } else {
                gridElement.classList.add('grid');
                gridElement.innerHTML = wishlist.map(p => createProductCard(p)).join('');
            }
            lucide.createIcons();
        }

        function renderProductDetail(productId) {
            const product = allInventory.find(p => p.id === productId);
            if (!product) return;
            const container = document.getElementById('view-product-detail');
            container.innerHTML = `
                <button onclick="handleBack()" class="flex items-center gap-2 text-zinc-400 hover:text-[#FFEE00] uppercase font-black text-[10px] tracking-widest mb-12 transition-colors relative z-[110]">
                    <i data-lucide="chevron-left" size="14"></i> Back
                </button>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-24 relative z-[110]">
                    <div class="space-y-6">
                        <div class="relative aspect-square bg-themed-secondary overflow-hidden cursor-pointer group/mainimg shadow-lg" onclick="toggleProductImage('${product.imgFront}', '${product.imgBack}')">
                            <img src="${product.imgFront}" id="main-product-img" class="w-full h-full object-cover transition-opacity duration-500">
                            <div class="absolute bottom-4 right-4 bg-black/50 backdrop-blur-md p-3 rounded-full opacity-0 group-hover/mainimg:opacity-100 transition-opacity"><i data-lucide="refresh-cw" class="text-white" size="20"></i></div>
                        </div>
                        <div class="flex gap-4 overflow-x-auto pb-2 custom-scroll">
                            <button onclick="document.getElementById('main-product-img').src='${product.imgFront}'" class="w-20 min-w-[5rem] aspect-square bg-themed-secondary overflow-hidden border border-zinc-200 dark:border-white/10 hover:border-[#FFEE00] transition-colors"><img src="${product.imgFront}" class="w-full h-full object-cover opacity-60 hover:opacity-100"></button>
                            <button onclick="document.getElementById('main-product-img').src='${product.imgBack}'" class="w-20 min-w-[5rem] aspect-square bg-themed-secondary overflow-hidden border border-zinc-200 dark:border-white/10 hover:border-[#FFEE00] transition-colors"><img src="${product.imgBack}" class="w-full h-full object-cover opacity-60 hover:opacity-100"></button>
                        </div>
                    </div>
                    <div class="flex flex-col text-primary">
                        <div class="flex flex-col gap-2 mb-4">
                            <div class="flex items-center gap-4">
                                <p class="text-[#FFEE00] font-black uppercase tracking-[0.3em] font-black font-black font-black">${product.category}</p>
                                ${product.isSpecial ? `<span class="bg-[#FFEE00] text-black text-[8px] font-black px-2 py-0.5 uppercase tracking-tighter">Special Edition Colorway</span>` : ''}
                                ${productId.startsWith('ah') ? `<span class="bg-white text-black text-[8px] font-black px-2 py-0.5 uppercase tracking-tighter border border-white/10">LTD SUPPLY: ${product.units}</span>` : ''}
                            </div>
                            <button onclick="toggleWishlist('${product.id}')" class="w-fit text-zinc-400 hover:text-[#FFEE00] transition-colors">
                                <i data-lucide="heart" size="24" class="${wishlist.some(i => i.id === product.id) ? 'fill-[#FFEE00] text-[#FFEE00]' : ''}"></i>
                            </button>
                        </div>
                        <h1 class="text-3xl md:text-6xl font-black uppercase tracking-tighter mb-6 leading-tight text-primary font-black">${product.name}</h1>
                        <p class="text-2xl md:text-3xl font-mono mb-12 text-primary">${product.oldPrice ? `<span class="line-through text-zinc-400 mr-4">${product.oldPrice}</span>` : ''}<span class="text-[#FFEE00] font-bold">${product.price}</span></p>
                        <div class="space-y-8 mb-12 text-primary font-black">
                            <p class="text-zinc-500 text-[10px] font-black uppercase tracking-widest mb-4">Select Size</p>
                            <div class="flex flex-wrap gap-3" id="size-selector-detail">
                                ${['S', 'M', 'L', 'XL', '2XL'].map(size => `<button onclick="selectDetailSize(this, '${size}')" class="w-14 h-14 md:w-16 md:h-16 border border-zinc-200 dark:border-white/10 flex items-center justify-center font-black hover:border-[#FFEE00] hover:text-[#FFEE00] transition-colors uppercase text-primary font-black">${size}</button>`).join('')}
                            </div>
                        </div>
                        <button id="add-to-bag-detail-btn" onclick="addToCartDetail('${product.id}')" class="w-full bg-[#FFEE00] text-black py-6 font-black uppercase tracking-tighter hover:bg-black hover:text-white transition-all transform hover:-translate-y-1 mb-12 shadow-xl font-black">Add to bag</button>
                        <div class="space-y-12 text-primary font-black">
                            <div><p class="text-zinc-500 text-[10px] font-black uppercase tracking-widest mb-4 font-black">The Vision</p><p class="text-zinc-500 dark:text-zinc-300 leading-relaxed font-medium italic text-sm md:text-base">${(product.desc || sanctuaryDesc).replace(/\n/g, '<br/>')}</p></div>
                            <div class="grid grid-cols-2 gap-8 pt-8 border-t border-zinc-100 dark:border-white/5"><div><p class="text-zinc-500 text-[10px] font-black uppercase tracking-widest mb-2 font-black">Material</p><p class="text-[10px] md:text-xs font-bold uppercase text-primary font-bold font-black">${product.material || "100% Heavyweight Cotton"}</p></div><div><p class="text-zinc-500 text-[10px] font-black uppercase tracking-widest mb-2 font-black">Print</p><p class="text-[10px] md:text-xs font-bold uppercase text-primary font-bold font-black">Eco-friendly Water-based</p></div></div>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function refreshCurrentView() {
            if (currentView === 'home') document.getElementById('essentials-preview-grid').innerHTML = collection.slice(0, 4).map(e => createProductCard(e)).join('');
            else if (['new_drop', 'men', 'women', 'sale', 'outerwear', 'streetwear', 'accessories', 'essentials'].includes(currentView)) renderCollection(currentView);
            else if (currentView === 'coming_soon') renderComingSoon();
            else if (currentView === 'wishlist') renderWishlist();
            else if (currentView === 'product_detail') renderProductDetail(currentProductId);
            lucide.createIcons();
        }

        function toggleProductImage(front, back) {
            const img = document.getElementById('main-product-img');
            if (img.src.includes(front)) img.src = back; else img.src = front;
        }

        function handleSearch(query) {
            const grid = document.getElementById('search-results-grid');
            if (!query) { grid.innerHTML = ''; return; }
            const filtered = allInventory.filter(item => item.name.toLowerCase().includes(query.toLowerCase()));
            grid.innerHTML = filtered.length ? filtered.map(i => createProductCard(i)).join('') : '<p class="col-span-full text-zinc-400 uppercase font-black text-center py-20 text-primary">No items found matching your query.</p>';
            lucide.createIcons();
        }

        function showNotification(textMsg) {
            const notif = document.getElementById('add-notification');
            const text = document.getElementById('notif-text');
            text.innerText = textMsg || `Added to Bag`;
            notif.classList.add('show');
            const cartBtn = document.getElementById('cart-nav-btn');
            cartBtn.classList.add('cart-pop-active');
            setTimeout(() => { notif.classList.remove('show'); cartBtn.classList.remove('cart-pop-active'); }, 2500);
        }

        function removeFromCart(cartId) {
            cart = cart.filter(i => i.cartId !== cartId);
            updateCartUI();
            saveProgress();
        }

        function updateCartUI() {
            document.getElementById('cart-count').innerText = cart.length;
            const container = document.getElementById('cart-items-container');
            const footer = document.getElementById('cart-footer');
            if (cart.length === 0) {
                container.innerHTML = `<div class="py-20 text-center border border-zinc-100 dark:border-white/5 bg-themed-secondary"><p class="text-zinc-400 uppercase font-black">Your bag is empty.</p></div>`;
                footer.classList.add('hidden');
            } else {
                container.innerHTML = cart.map(item => `
                    <div class="flex gap-4 md:gap-6 items-center border-b border-zinc-100 dark:border-white/5 pb-6 text-primary font-black">
                        <div class="w-16 h-16 md:w-20 md:h-20 bg-themed-secondary overflow-hidden"><img src="${item.imgFront}" class="w-full h-full object-cover ${item.id.startsWith('ah') ? 'grayscale' : ''}"></div>
                        <div class="flex-grow text-primary font-black">
                            <h4 class="font-bold uppercase tracking-tight text-xs md:text-sm leading-tight font-bold font-black font-black">${item.name}</h4>
                            <p class="text-zinc-500 font-mono text-[10px] mt-1 uppercase tracking-tighter font-black font-black">Size: ${item.size} — ${item.price}</p>
                        </div>
                        <button onclick="removeFromCart(${item.cartId})" class="text-zinc-400 hover:text-red-500 transition-colors"><i data-lucide="trash-2" size="18"></i></button>
                    </div>
                `).join('');
                footer.classList.remove('hidden');
                const total = cart.reduce((acc, curr) => acc + parseFloat(curr.price.replace('$', '')), 0);
                document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
            }
            lucide.createIcons();
        }

        function selectDetailSize(btn, size) {
            document.querySelectorAll('#size-selector-detail button').forEach(b => {
                b.classList.remove('bg-[#FFEE00]', 'text-black', 'border-[#FFEE00]');
                b.classList.add('border-zinc-200', 'dark:border-white/10');
            });
            btn.classList.add('bg-[#FFEE00]', 'text-black', 'border-[#FFEE00]');
            btn.classList.remove('border-zinc-200', 'dark:border-white/10');
            selectedDetailSize = size;
        }

        function addToCartDetail(productId) {
            if (!selectedDetailSize) { showNotification("Please select a size"); return; }
            const product = allInventory.find(i => i.id === productId);
            if (product) {
                cart.push({ ...product, size: selectedDetailSize, cartId: Date.now() });
                updateCartUI();
                saveProgress();
                showNotification(`Added to Bag (${selectedDetailSize})`);
                selectedDetailSize = null;
                document.querySelectorAll('#size-selector-detail button').forEach(b => {
                    b.classList.remove('bg-[#FFEE00]', 'text-black', 'border-[#FFEE00]');
                    b.classList.add('border-zinc-200', 'dark:border-white/10');
                });
            }
        }

        // Init
        window.addEventListener('scroll', () => {
            const nav = document.getElementById('navbar');
            if (window.scrollY > 20) nav.classList.add('scrolled');
            else nav.classList.remove('scrolled');
        });

        window.onload = () => {
            loadTheme();
            loadProgress();
            document.getElementById('essentials-preview-grid').innerHTML = collection.slice(0, 4).map(e => createProductCard(e)).join('');
            lucide.createIcons();
            updateCartUI();
        };
    </script>
</body>
</html>
